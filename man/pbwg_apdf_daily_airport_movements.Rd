% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apdf.R
\name{pbwg_apdf_daily_airport_movements}
\alias{pbwg_apdf_daily_airport_movements}
\title{Daily APDF airport summary}
\usage{
pbwg_apdf_daily_airport_movements(
  airports,
  wef,
  til,
  conn = NULL,
  domestic_prefixes = pbwg_apdf_domestic_prefixes_default()
)
}
\arguments{
\item{airports}{Character vector of ICAO airport codes.}

\item{wef}{Start date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{til}{End date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{conn}{Optional Oracle \link[DBI:DBIConnection-class]{DBI::DBIConnection}. When omitted a fresh
connection to \code{PRUDEV} is created via \code{\link[eurocontrol:db_connection]{eurocontrol::db_connection()}}, with
access to \code{SWH_FCT.V_FAC_FLIGHT_MS} and \code{PRUDEV.V_PRU_AIRCRAFT_CATEGORY}.}

\item{domestic_prefixes}{Character prefixes used to flag domestic traffic via
\code{\link[=pbwg_apdf_is_domestic]{pbwg_apdf_is_domestic()}}. Defaults to the ECTL set defined in
\code{\link[=pbwg_apdf_domestic_prefixes_default]{pbwg_apdf_domestic_prefixes_default()}}.}
}
\value{
Tibble with one row per airport per day containing:
\itemize{
\item{\code{ICAO}}{Airport code.}
\item{\code{DATE}}{Movement date (UTC).}
\item{\code{ARRS}}{Arrival count.}
\item{\code{DEPS}}{Departure count.}
\item{\code{HEAVY}}{Heavy wake turbulence movements.}
\item{\code{MED}}{Medium wake turbulence movements.}
\item{\code{LIGHT}}{Light wake turbulence movements.}
\item{\code{ARRS_DOM}}{Domestic arrivals matched on ICAO prefixes.}
\item{\code{DEPS_DOM}}{Domestic departures matched on ICAO prefixes.}
}
}
\description{
Rebuilds the parquet-export workflow from the PBWG tooling: pulls APDF
movements per airport, coerces registrations/types to the PBWG shape, and
aggregates daily arrivals/departures with a heavy/medium/light split. Date
ranges spanning multiple years are handled in yearly chunks to keep queries
manageable.
}
