% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flight_list.R
\name{pbwg_market_segment_tfc_counts}
\alias{pbwg_market_segment_tfc_counts}
\title{NM area traffic by market segment}
\usage{
pbwg_market_segment_tfc_counts(wef, til, conn = NULL)
}
\arguments{
\item{wef}{Start date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{til}{End date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{conn}{Optional Oracle \link[DBI:DBIConnection-class]{DBI::DBIConnection}. When omitted a fresh
connection to \code{PRUDEV} is created via \code{\link[eurocontrol:db_connection]{eurocontrol::db_connection()}}, with
access to \code{SWH_FCT.V_FAC_FLIGHT_MS} and \code{PRUDEV.V_PRU_AIRCRAFT_CATEGORY}.}
}
\value{
A \code{\link[tibble:tibble]{tibble::tibble()}} with one row per day/market segment and an
attached \code{"sql"} attribute. Columns:
\itemize{
\item \code{YEAR}: numeric year extracted from \code{ENTRY_DATE}.
\item \code{MONTH}: numeric month extracted from \code{ENTRY_DATE}.
\item \code{ENTRY_DATE}: truncated IFPZ entry date (UTC).
\item \code{MARKET_SEGMENT}: market segment label from \code{DIM_FLIGHT_TYPE_RULE}.
\item \code{MARKET_SEGMENT_DESCR}: description from \code{DIM_FLIGHT_TYPE_RULE}.
\item \code{UNIT_CODE}: fixed \code{"NM_AREA"}.
\item \code{UNIT_NAME}: fixed \code{"Total Network Manager Area"}.
\item \code{FLIGHT}: count of flights for the date/segment combination.
}
}
\description{
Counts Network Manager area flights per day and market segment, filtering the
flights fact to operational statuses (\code{TE}, \code{TA}, \code{AA}) and the requested
date window. Segments are resolved through \code{SWH_FCT.DIM_FLIGHT_TYPE_RULE},
and missing day/segment combinations are backfilled with zeros to give a
complete calendar grid.
}
