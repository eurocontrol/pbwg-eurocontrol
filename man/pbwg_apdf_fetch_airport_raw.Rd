% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apdf.R
\name{pbwg_apdf_fetch_airport_raw}
\alias{pbwg_apdf_fetch_airport_raw}
\title{Fetch APDF records for a single airport}
\usage{
pbwg_apdf_fetch_airport_raw(
  airport,
  wef,
  til,
  columns = pbwg_apdf_columns_default(),
  conn = NULL
)
}
\arguments{
\item{airport}{ICAO airport designator (e.g. \code{"EIDW"}). Only a single code is
allowed.}

\item{wef}{Start date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{til}{End date (inclusive). Can be anything that
\code{\link[lubridate:as_date]{lubridate::as_date()}} understands.}

\item{columns}{Vector of column names to include. Defaults to the exact set
used by the Python scripts; see \code{\link[=pbwg_apdf_columns_default]{pbwg_apdf_columns_default()}} for details.}

\item{conn}{Optional Oracle \link[DBI:DBIConnection-class]{DBI::DBIConnection}. When omitted a fresh
connection to \code{PRUDEV} is created via \code{\link[eurocontrol:db_connection]{eurocontrol::db_connection()}}, with
access to \code{SWH_FCT.V_FAC_FLIGHT_MS} and \code{PRUDEV.V_PRU_AIRCRAFT_CATEGORY}.}
}
\value{
A \code{\link[tibble:tibble]{tibble::tibble()}} with the requested APDF columns and an attached
\code{"sql"} attribute describing the filter. Key fields include:
\itemize{
\item \code{AP_C_FLTID}: flight identifier (source airport).
\item \code{AP_C_FLTRUL}: rules under which the flight operates (\code{IFR}, \code{VFR}, \code{NA}).
\item \code{AP_C_REG}: aircraft registration with separators removed.
\item \code{ADEP_ICAO} / \code{ADES_ICAO}: departure/destination aerodrome (ICAO code).
\item \code{SRC_PHASE}: \code{DEP} for departures, \code{ARR} for arrivals.
\item \code{MVT_TIME_UTC} / \code{BLOCK_TIME_UTC} / \code{SCHED_TIME_UTC}: movement, block and
scheduled times in UTC.
\item \code{ARCTYP}: ICAO aircraft type code (e.g. \code{A21N}).
\item \code{AC_CLASS}: wake turbulence class (kept for H/M/L aggregation).
\item \code{AP_C_RWY} / \code{AP_C_STND}: runway and stand identifiers.
\item \verb{C40_*} / \verb{C100_*}: first/last crossing time, position, level and bearing
at 40 NM and 100 NM from the aerodrome reference point.
}
}
\description{
Queries \code{SWH_FCT.FAC_APDS_FLIGHT_IR691} via \code{\link[eurocontrol:apdf_tbl]{eurocontrol::apdf_tbl()}}, filters
to one airport and date window, then collects the rows used by the legacy
pbwg-ectl-query-tool. The default column set mirrors the Python extract and
keeps operational details (\code{AC_CLASS}, runway/stand, movement times) that are
dropped by \code{eurocontrol::apdf_tidy()}.
}
